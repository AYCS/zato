{% extends "zato/index.html" %}

{% block extra_css %}
{% endblock %}

{% block extra_js %}
    <script type="text/javascript" src="/static/js/common.js"></script>
    <script type="text/javascript" src="/static/js/stats/settings.js"></script>
{% endblock %}

{% block content %}

{% if not zato_clusters %}
    <p>
    There aren't any Zato clusters registered with this ZatoAdmin instance.
    <a href="{% url cluster %}" class="common">Click here</a> to register a new cluster first.
    <br/><br/>
    </p>
{% else %}

<h2 class="zato">Statistics : Settings</h2>

<div id="user-message-div" style='display:none'><pre id="user-message" class="user-message"></pre></div>


    <div class="prompt">
    {% if not cluster_id %}
        Choose a cluster to configure the statistics settings of
    {% endif %}

    <form action="." method="get">
        {{ choose_cluster_form.cluster }}
        <input type="submit" value="Show settings" />
    </form>
    </div>

{% if cluster_id %}

<div id="markup">
    <form action="." method="post">
    <table id="data-table">
        <tr>
            <td class="inline_header" colspan="4">Scheduler</td>
        </tr>
        <tr>
            <td style="width:15%">How often to process raw statistics</td>
            <td style="width:30%" style="text-align:left">{{ form.scheduler_raw_stats_time }} <span class="form_hint">seconds (default: 90)</span></td>
            <td style="width:15%">At most, how many raw statistics to process in one batch</td>
            <td style="width:30%" style="text-align:left">{{ form.scheduler_raw_stats_time }} <span class="form_hint">(default: 99999)</span></td>
        </tr>
        <tr>
            <td>How often to aggregate per-minute statistics</td>
            <td style="width:30%" style="text-align:left">{{ form.scheduler_raw_stats_time }} <span class="form_hint">seconds (default: 60)</span></td>
            <td colspan="2"></td>
        </tr>
        <tr>
            <td class="inline_header" colspan="4">Attention grabbers</td>
        </tr>
        <tr>
            <td style="width:15%">Slow service threshold</td>
            <td style="width:30%" style="text-align:left">{{ form.scheduler_raw_stats_time }} <span class="form_hint">ms (default: 2000)</span></td>
            <td style="width:15%">Top service usage threshold</td>
            <td style="width:30%" style="text-align:left">{{ form.scheduler_raw_stats_time }} <span class="form_hint">% (default: 10)</span></td>
        </tr>
        <tr>
            <td colspan="4" style="text-align:right;border-top:1px solid #ddd"><button id="save_settings" name="save_settings" type="submit">Save settings</button></td>
        </tr>
    </table>
    </form>
</div>


{% endif %} {% comment %}cluster_id{% endcomment %}
{% endif %} {% comment %}zato_clusters{% endcomment %}


{% endblock %}
